"use strict";var express=require("express"),router=express.Router(),_require=require("../db/db"),find=_require.find,insert=_require.insert,deletes=_require.deletes,update=_require.update,finds=_require.finds;router.post("/login",function(r,n){var t,s,o,a,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n.append("Access-Control-Allow-Origin","*"),r.query,t=r.body,s=t.username,o=String(t.password),e.next=7,regeneratorRuntime.awrap(find("user",{username:s,password:o}));case 7:a=e.sent,i={},i=a.length?{message:"登录成功",code:0}:{message:"账号密码错误",code:1},n.json(i);case 11:case"end":return e.stop()}})}),router.get("/list",function(e,r){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r.append("Access-Control-Allow-Origin","*"),e.next=3,regeneratorRuntime.awrap(find("goodlist"));case 3:n=e.sent,r.json(n);case 5:case"end":return e.stop()}})}),router.get("/goods",function(e,r){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r.append("Access-Control-Allow-Origin","*"),e.next=3,regeneratorRuntime.awrap(find("brand"));case 3:n=e.sent,r.json(n);case 5:case"end":return e.stop()}})}),router.get("/order",function(e,r){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r.append("Access-Control-Allow-Origin","*"),e.next=3,regeneratorRuntime.awrap(find("order"));case 3:n=e.sent,r.json(n);case 5:case"end":return e.stop()}})}),router.post("/selectBrand",function(r,n){var t,s,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n.append("Access-Control-Allow-Origin","*"),r.query,t=r.body,s=Number(t.bid),e.next=6,regeneratorRuntime.awrap(find("brand",{bid:s}));case 6:o=e.sent,n.json(o);case 8:case"end":return e.stop()}})}),router.post("/order1",function(r,n){var t,s,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:for(s in n.append("Access-Control-Allow-Origin","*"),r.query,t=r.body)""===t[s]&&delete t[s];return e.next=6,regeneratorRuntime.awrap(find("order",t));case 6:o=e.sent,n.json(o);case 8:case"end":return e.stop()}})}),router.post("/selectBrand",function(r,n){var t,s,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n.append("Access-Control-Allow-Origin","*"),r.query,t=r.body,s=Number(t.bid),e.next=6,regeneratorRuntime.awrap(find("brand",{bid:s}));case 6:o=e.sent,n.json(o);case 8:case"end":return e.stop()}})}),router.post("/goods1",function(r,n){var t,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n.append("Access-Control-Allow-Origin","*"),r.query,t=r.body,e.next=5,regeneratorRuntime.awrap(find("brand",t));case 5:s=e.sent,n.json(s);case 7:case"end":return e.stop()}})}),router.post("/dels",function(r,n){var t,s,o,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n.append("Access-Control-Allow-Origin","*"),r.query,t=r.body,s=t.gid-0,e.next=6,regeneratorRuntime.awrap(deletes("goodlist",{gid:s}));case 6:o=e.sent,a={},a=o?"删除成功呢":"删除失败",n.send(a);case 10:case"end":return e.stop()}})}),router.post("/delgood",function(r,n){var t,s,o,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n.append("Access-Control-Allow-Origin","*"),r.query,t=r.body,s=t.bid-0,e.next=6,regeneratorRuntime.awrap(deletes("brand",{bid:s}));case 6:o=e.sent,a={},a=o?"删除成功呢":"删除失败",n.send(a);case 10:case"end":return e.stop()}})}),router.post("/delorder",function(r,n){var t,s,o,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n.append("Access-Control-Allow-Origin","*"),r.query,t=r.body,s=t.id-0,e.next=6,regeneratorRuntime.awrap(deletes("order",{id:s}));case 6:o=e.sent,a={},a=o?"删除订单成功呢":"删除订单失败",n.send(a);case 10:case"end":return e.stop()}})}),router.post("/adds",function(r,n){var t,s,o,a,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n.append("Access-Control-Allow-Origin","*"),r.query,t=r.body,s=1*t.key,o=t.title,a=1*t.gid,i={},e.next=9,regeneratorRuntime.awrap(find("goodlist",{gid:a,key:s,title:o}));case 9:if(0<e.sent.length)return e.next=13,regeneratorRuntime.awrap(update("goodlist",{gid:a,key:s},{$set:{gid:a,key:s,title:t.title,kucun:t.kucun,price:t.price,sales:t.sales,"推荐":!0,"新品":!0,"上架":!0}}));e.next=17;break;case 13:e.sent&&(i={inf:"修改商品成功",code:0}),e.next=21;break;case 17:return e.next=19,regeneratorRuntime.awrap(insert("goodlist",[{gid:a,key:s,title:t.title,kucun:t.kucun,price:t.price,sales:t.sales,"推荐":!0,"新品":!0,"上架":!0}]));case 19:e.sent&&(i={inf:"添加商品成功",code:1});case 21:n.send(i);case 22:case"end":return e.stop()}})}),router.post("/commit",function(r,n){var t,s,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n.append("Access-Control-Allow-Origin","*"),r.query,t=r.body,console.log(t),s=1*t.bid,console.log(s),e.next=8,regeneratorRuntime.awrap(update("brand",{bid:s},{$set:{title:t.title,upcase:t.upcase,story:t.story,rank:t.rank,product:t.product,isshow:t.isshow}}));case 8:o=e.sent,result=o?{inf:"修改商品成功",code:0}:{inf:"修改商品失败",code:1},n.send(result);case 11:case"end":return e.stop()}})}),module.exports=router;